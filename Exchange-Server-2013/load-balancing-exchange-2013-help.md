---
title: '負載平衡: Exchange 2013 Help'
TOCTitle: 負載平衡
ms:assetid: f572c193-6f3a-400e-9085-a9d3e5e18c59
ms:mtpsurl: https://technet.microsoft.com/zh-tw/library/JJ898588(v=EXCHG.150)
ms:contentKeyID: 51409236
ms.date: 05/21/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# 負載平衡

 

_**適用版本：**Exchange Server 2013_

_**上次修改主題的時間：**2016-12-09_

負載平衡是一種管理伺服器接收流量的方式。負載平衡有助於分散各種端點 (例如「用戶端存取伺服器」) 的傳入用戶端連線，以確保沒有任何一個端點所佔的負載共用比例失衡。負載平衡亦可在一或多個端點故障時提供容錯移轉備援功能。將負載平衡與 Exchange Server 2013 併用，即可確保使用者在電腦發生故障的情形下，仍然能夠持續享有 Exchange 服務。負載平衡亦可讓您的部署處理超過一部伺服器所能處理的流量，同時並為用戶端提供單一主機名稱。

負載平衡有兩個主要的用途。減輕其中一個 Active Directory 站台中單一「用戶端存取伺服器」故障所造成的影響。此外，負載平衡可確保平均分散每部「用戶端存取伺服器」上的負載。

Exchange 2013 同時還包括下列針對轉換與容錯移轉備援的解決方案：

  - **高可用性** Exchange 2013 使用資料庫可用性群組 (DAG)，可針對位於各部伺服器上的信箱同步處理並保留多份複本。如此一來，若其中一部伺服器上的信箱資料庫發生故障，使用者即可連線至另一部伺服器上的同步處理資料庫複本。

  - **站台恢復**您可以在個別地理位置部署兩個 Active Directory 站台、讓兩者之間的信箱資料保持同步，並在某個站台故障時讓另一個站台處理整個負載。

  - **線上信箱移動**在線上信箱移動中，使用者可在移動期間存取其電子郵件帳戶。只有在程序結束時 (開始進行最後的同步處理時)，使用者才會有一小段時間無法存取帳戶。您可以跨樹系或在相同樹系中執行線上信箱移動。

  - **陰影備援**   陰影備援可在傳輸郵件時保護郵件的可用性和復原能力。使用陰影備援時，從傳輸資料庫刪除郵件時會發生延遲，直到傳輸伺服器驗證該郵件的所有下一個躍點都已完成為止。如果在報告成功傳遞之前有任何下一個躍點失敗，便會重新提交郵件以便遞送至未完成的躍點。

## Exchange Server 2013 負載平衡功能的架構變更

在 Exchange Server 2010 中，是由 Client Access server role 負責用戶端連線與處理。這需要讓外部與內部 Outlook 連線，以及行動裝置與協力廠商用戶端連線在部署的全體 Client Access Server 陣列當中保持負載平衡，以達到容錯和有效善用伺服器的需求。許多 Exchange 2010 用戶端存取通訊協定皆要求相似性 - 亦即用戶端與特定 Client Access Server 之間的關係。尤其是 Outlook Web App、Exchange 控制台、Exchange Web 服務、Outlook Anywhere、Outlook TCP/IP MAPI 連線、Exchange ActiveSync、Exchange 通訊錄服務以及 Remote PowerShell，皆會要求用戶端對 Client Access Server 的相似性，或是可透過此相似性而獲益。包含下列 Exchange 2010 負載平衡選項：

  - Windows 網路負載平衡 (具備來源 IP 相似性)

  - 硬體負載平衡

因為用戶端通訊協定中Exchange 2010受限於較需求，我們建議使用第 7 層負載平衡解決方案。階層 7，又稱為應用程式層級的負載平衡，允許的負載平衡解決方案来用來判斷如何假設用戶端與伺服器之間的整個對話就是可用的負載平衡器邏輯平衡進入系統每次要求的複合規則。這些複雜規則可確保從特定的用戶端的所有要求都發生至相同的用戶端存取伺服器端點。Exchange 2010，在來自特定用戶端的所有要求沒有未時所需相關性的通訊協定相同端點的使用者經驗會造成負面受到影響。如需Exchange 2010負載平衡選項的詳細資訊，請參閱[在 Exchange 2010 瞭解負載平衡](https://go.microsoft.com/fwlink/p/?linkid=196447)。

在 Exchange Server 2013 中共有兩大主要的伺服器類型 - Client Access Server 與 Mailbox Server。Exchange 2013 中的 Client Access Server 可作為輕巧、無狀態的伺服器，可讓用戶端連線至 Exchange 2013 Mailbox Server。Client Access Server 提供整合命名空間與驗證。此外，Exchange 2013 Client Access Server 還可：

  - 支援適用於用戶端通訊協定的 Proxy 和重新導向邏輯。

  - 支援使用「第 4 層」負載平衡。

工作階段相似性與「第 7 層」負載平衡可依各種通訊協定的需要，將用戶端與伺服器之間的所有要求傳送至相同的端點。這些要求會分散於應用程式層。「第 4 層」負載平衡會將這些要求分散於傳輸層。負載平衡解決方案可針對感知單一 IP 位址 (有時稱為虛擬 IP 位址或 VIP) 的用戶端，將其要求分散至執行工作的一組伺服器。判斷要求內容前必須建立用戶端與伺服器之間的連線，才能讓負載平衡器在檢查要求內容之前選取接收要求的伺服器。您可透過各種方式選取目標伺服器，例如「循環配置資源」可讓每個輸入連線傳送至循環清單中的下一個目標伺服器，而「最少連線」可讓負載平衡器將每個新連線傳送至當下建立連線數最少的伺服器。由於不要求工作階段相似性，因此您在部署負載平衡架構時可擁有更高的彈性、選擇性以及精簡性。無需工作階段相似性的負載平衡可讓您提升負載平衡器的容量與使用率，這是因為系統不會使用處理來維護更多相關的相似性選項，例如 Cookie 式負載平衡或「安全通訊端層」(SSL) 工作階段 ID。

## Client Access Server 陣列與 Exchange 2013

Exchange 2010 導入了「用戶端存取」陣列概念。針對 Active Directory 站台設定「用戶端存取」陣列後，站台中的所有 Client Access Server 皆會自動成為陣列成員。最新的 Exchange 2013 組建無須使用「用戶端存取」陣列，這是因為部署負載平衡以及高可用性服務來得更加簡易。

## 負載平衡解決方案

使用硬體負載平衡器仍然支援Exchange 2013。硬體負載平衡解決方案的相關資訊的已完成解決方案測試的Exchange 2010和將可能工時也一樣使用Exchange 2013，請參閱[Exchange Server 2010 負載平衡器部署](https://go.microsoft.com/fwlink/p/?linkid=261834)。請記住此頁面上顯示的硬體負載平衡器與Exchange 2010較複雜的 7 層組態。負載平衡Exchange 2013流量可以更簡單授與此主題稍早所述的架構變更。而不是設定 Exchange 通訊協定的每個工作階段親和性，到Exchange 2013用戶端存取伺服器的傳入的連線可以將您導向可用的伺服器的負載平衡器與處理所需的任何其他親和性。硬體負載平衡器上仍有重要的角色中提供的 Exchange 服務的高可用性因為它可以偵測特定的用戶端存取伺服器具有變成無法使用時及移除的伺服器會處理傳入的連線設定。

## Windows 網路負載平衡

「Windows 網路負載平衡」(WNLB) 是最常用於 Exchange 伺服器的軟體負載平衡器。使用 Microsoft Exchange 部署 WNLB 具有幾項相關限制。

  - 您無法在同樣使用信箱 DAG 的 Exchange 伺服器上使用 WNLB，這是因為 WNLB 與 Windows 容錯移轉叢集並不相容。如果使用的是 Exchange 2013 DAG 且想要使用 WNLB，您必須在個別伺服器上執行 Client Access server role 和 Mailbox server role。

  - WNLB 不會偵測服務中斷情形。WNLB 只會藉由 IP 位址偵測伺服器中斷情形。這表示如果特定的 Web 服務 (如 Outlook Web App) 發生錯誤，但伺服器仍在運作中，則 WNLB 不會偵測故障情形，且仍會將要求路由傳送至該 Client Access Server。此時需要手動介入，從負載平衡集區中移除中斷的 Client Access Server。

  - 使用 WNLB 可能會造成通訊埠氾濫的情形，而這可能會使網路癱瘓。

  - 由於 WNLB 只會使用來源 IP 位址來執行用戶端相似性，因此當來源 IP 集區很少時不是有效的解決方案。來源 IP 集區是來自遠端網路的子網路，或您的組織使用網路位址轉譯時，都會發生這種情形。

